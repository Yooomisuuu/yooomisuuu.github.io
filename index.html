<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶≠</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yomi's World</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Comic Sans MS", "Arial Rounded MT Bold", sans-serif; }
        body { background: #ffe6f2 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="%23ffb3d9" fill-opacity="0.2" d="M30,10 Q50,0 70,10 Q90,20 90,40 Q90,60 70,70 Q50,80 30,70 Q10,60 10,40 Q10,20 30,10 Z"/></svg>'); color: #5a2e48; overflow-x: hidden; position: relative; }
        
        /* ‰æßËæπÊ†è */
        .sidebar { position: fixed; left: 0; top: 0; height: 100vh; width: 220px; background: #ff99cc; padding: 30px 15px; box-shadow: 2px 0 10px rgba(0,0,0,0.1); z-index: 999; }
        .sidebar h2 { color: white; text-align: center; margin-bottom: 40px; font-size: 20px; text-shadow: 1px 1px 2px #ff66b3; }
        .sidebar-btn { display: block; width: 100%; padding: 12px 15px; margin: 10px 0; background: white; border: none; border-radius: 20px; color: #ff66b3; font-size: 14px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .sidebar-btn:hover { background: #ff66b3; color: white; transform: translateX(5px); }
        
        /* ÁôªÂΩïÂå∫Âüü */
        .login-section { text-align: center; margin-bottom: 20px; }
        .login-btn { padding: 10px 15px; background: #ff66b3; color: white; border: none; border-radius: 20px; cursor: pointer; width: 100%; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .login-btn:hover { background: #ff3399; transform: scale(1.05); }
        
        /* ‰∏ªÂÜÖÂÆπÂå∫ */
        .main-content { margin-left: 220px; padding: 40px; min-height: 100vh; position: relative; }
        .page-title { color: #ff66b3; font-size: 26px; margin-bottom: 30px; text-align: center; text-shadow: 1px 1px 3px #ffb3d9; }
        .content-section { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 5px 15px rgba(255, 102, 179, 0.1); margin-bottom: 30px; }
        .section-title { color: #ff66b3; font-size: 20px; margin-bottom: 1rem; border-bottom: 2px solid #ffb3d9; padding-bottom: 0.5rem; text-shadow: 1px 1px 2px #ffd6e8; }
        
        /* ÊåâÈíÆÊ†∑Âºè */
        .add-folder-btn, .add-target-btn { display: inline-block; padding: 10px 20px; background: #ff66b3; color: white; border: none; border-radius: 20px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .add-folder-btn:hover, .add-target-btn:hover { background: #ff3399; transform: scale(1.05); }
        .add-target-btn { position: absolute; top: 25px; right: 25px; }
        
        /* Êñá‰ª∂Â§π/Êñá‰ª∂Ê†∑Âºè */
        .media-section { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1.5rem; margin-top: 1rem; padding: 1rem; background: #fff8fc; border-radius: 15px; border: 1px solid #ffd6e8; }
        .folder-item, .file-item { display: flex; flex-direction: column; align-items: center; padding: 1rem; border-radius: 12px; background: #fff; border: 1px solid #ffd6e8; cursor: pointer; transition: all 0.2s ease; position: relative; height: 160px; justify-content: center; }
        .folder-item:hover, .file-item:hover { background: #fff0f7; border-color: #ff66b3; box-shadow: 0 4px 12px rgba(255, 102, 179, 0.15); }
        .folder-icon, .file-icon { width: 70px; height: 70px; object-fit: contain; margin-bottom: 0.8rem; border-radius: 8px; }
        .folder-name, .file-name { width: 100%; text-align: center; padding: 4px 8px; border-radius: 8px; font-size: 14px; color: #5a2e48; word-break: break-word; max-height: 40px; overflow: hidden; }
        .file-name { font-size: 13px; }
        
        /* Âà†Èô§ÊåâÈíÆ */
        .delete-folder, .delete-file { position: absolute; top: 8px; right: 8px; background: #ff6666; color: white; border: none; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s ease; font-size: 12px; opacity: 0.8; }
        .delete-folder:hover, .delete-file:hover { background: #ff3333; transform: scale(1.1); opacity: 1; }
        
        /* ÁõÆÊ†áÊ†∑Âºè */
        .year-target-container { margin: 15px 0; padding: 15px; background: #fff8fc; border-radius: 15px; border: 1px solid #ffd6e8; }
        .year-header { display: flex; align-items: center; margin-bottom: 10px; font-size: 18px; color: #ff66b3; }
        .year-checkbox { margin-right: 10px; width: 20px; height: 20px; accent-color: #ff66b3; cursor: pointer; }
        .year-label { font-weight: bold; }
        .goals-list { margin-left: 30px; }
        .goal-item { display: flex; align-items: flex-start; margin: 8px 0; padding: 8px; border-radius: 8px; background: #fff; border: 1px solid #ffe6f2; }
        .goal-checkbox { margin-right: 10px; margin-top: 3px; width: 16px; height: 16px; accent-color: #ff66b3; cursor: pointer; }
        .goal-content { flex: 1; word-break: break-word; }
        .target-actions { margin-top: 10px; display: flex; gap: 10px; margin-left: 30px; }
        /* ÂÖ≥ÈîÆ‰øÆÊîπ1ÔºöÈªòËÆ§ÊòæÁ§∫ÁºñËæë/Âà†Èô§ÊåâÈíÆ */
        .target-edit-btn, .target-delete-btn { padding: 5px 10px; border: none; border-radius: 10px; cursor: pointer; transition: all 0.2s ease; font-size: 12px; display: inline-block; }
        .target-edit-btn { background: #ffb3d9; color: white; }
        .target-edit-btn:hover { background: #ff99cc; }
        .target-delete-btn { background: #ff6666; color: white; }
        .target-delete-btn:hover { background: #ff3333; }
        
        /* ÂºπÁ™óÊ†∑Âºè */
        .login-modal, .create-folder-modal, .exit-edit-modal, .target-modal, .folder-page-modal, .sticker-confirm-modal, .achievement-image-modal, .delete-sticker-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 2rem; border-radius: 20px; box-shadow: 0 0 20px rgba(255, 102, 179, 0.3); z-index: 1000; width: 90%; max-width: 500px; }
        .delete-sticker-modal { max-width: 400px; }
        .achievement-image-modal { max-width: 700px; text-align: center; }
        .sticker-confirm-modal { max-width: 400px; }
        .folder-page-modal { max-width: 800px; width: 95%; max-height: 90vh; overflow-y: auto; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 153, 204, 0.5); z-index: 999; }
        .achievement-image { max-width: 100%; max-height: 70vh; border-radius: 15px; margin: 15px 0; }
        
        /* ÂºπÁ™óÊéß‰ª∂ */
        .login-modal input, .create-folder-modal input, .target-modal input, .target-modal textarea { margin: 0.5rem 0; padding: 10px 15px; width: 100%; border: 2px solid #ffb3d9; border-radius: 15px; outline: none; color: #5a2e48; }
        .target-modal textarea { min-height: 150px; resize: vertical; font-family: inherit; }
        .confirmBtn, .saveTargetBtn, .confirmCreateFolderBtn, .upload-media-btn, .confirmStickerBtn, .confirmAchievementBtn, .confirmDeleteStickerBtn { background: #ff66b3; color: white; border: none; border-radius: 15px; padding: 10px 20px; cursor: pointer; margin-right: 10px; transition: all 0.3s ease; }
        .cancelBtn, .cancelTargetBtn, .cancelCreateFolderBtn, .close-folder-page, .cancelStickerBtn, .cancelAchievementBtn, .cancelDeleteStickerBtn { background: #ffb3d9; color: white; border: none; border-radius: 15px; padding: 10px 20px; cursor: pointer; transition: all 0.3s ease; }
        .confirmBtn:hover, .saveTargetBtn:hover, .confirmCreateFolderBtn:hover, .upload-media-btn:hover, .confirmStickerBtn:hover, .confirmAchievementBtn:hover, .confirmDeleteStickerBtn:hover { background: #ff3399; transform: scale(1.05); }
        .cancelBtn:hover, .cancelTargetBtn:hover, .cancelCreateFolderBtn:hover, .close-folder-page:hover, .cancelStickerBtn:hover, .cancelAchievementBtn:hover, .cancelDeleteStickerBtn:hover { background: #ff99cc; transform: scale(1.05); }
        
        /* Êñá‰ª∂Â§πÂõæÊ†á‰∏ä‰º† */
        .folder-icon-upload { margin: 1rem 0; padding: 1rem; border: 2px dashed #ffb3d9; border-radius: 15px; text-align: center; cursor: pointer; }
        .folder-icon-upload:hover { border-color: #ff66b3; background: #fff0f7; }
        .icon-preview { width: 80px; height: 80px; margin: 1rem auto; border-radius: 10px; object-fit: contain; background: #fff8fc; display: flex; align-items: center; justify-content: center; color: #ff66b3; font-size: 30px; }
        
        /* È¶ñÈ°µÊ†∑Âºè */
        .home-page { display: flex; flex-wrap: wrap; align-items: center; justify-content: center; gap: 50px; padding: 20px; }
        .profile-card { background: white; border-radius: 30px; padding: 30px; box-shadow: 0 5px 15px rgba(255, 102, 179, 0.2); max-width: 400px; }
        .profile-card h1 { color: #ff66b3; font-size: 28px; margin-bottom: 20px; text-align: center; }
        .profile-info { margin: 15px 0; line-height: 1.8; }
        .profile-info span { font-weight: bold; color: #ff66b3; }
        .cartoon-img { width: 300px; height: 300px; border-radius: 50%; object-fit: cover; border: 5px solid #ff99cc; box-shadow: 0 5px 15px rgba(255, 102, 179, 0.3); cursor: pointer; transition: all 0.2s ease; }
        .cartoon-img:hover { transform: scale(1.02); box-shadow: 0 8px 20px rgba(255, 102, 179, 0.4); }
        
        /* È¶ñÈ°µÁºñËæë */
        .profile-edit-tools { display: none; margin-top: 15px; padding: 10px; background: #fff8fc; border-radius: 10px; border: 1px solid #ffd6e8; }
        .edit-tool-group { margin: 8px 0; display: flex; align-items: center; gap: 10px; }
        .edit-tool-label { font-size: 14px; color: #5a2e48; min-width: 80px; }
        .color-picker, .font-select { padding: 5px; border: 1px solid #ffb3d9; border-radius: 8px; background: white; color: #5a2e48; }
        
        /* Ë¥¥Á∫∏Ê†∑Âºè */
        .sticker-button { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: #ff66b3; color: white; display: none; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 102, 179, 0.3); z-index: 900; transition: all 0.3s ease; }
        .sticker-button:hover { background: #ff3399; transform: scale(1.1); }
        /* Êñ∞Â¢ûÔºöË¥¥Á∫∏ÁºñËæëÂ∑•ÂÖ∑Ê†è */
        .sticker-toolbar { position: fixed; bottom: 100px; right: 30px; background: white; border-radius: 15px; padding: 10px; box-shadow: 0 4px 15px rgba(255, 102, 179, 0.3); z-index: 899; display: none; }
        .sticker-tool-btn { padding: 5px 10px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; background: #ffb3d9; color: white; font-size: 12px; transition: all 0.2s ease; }
        .sticker-tool-btn:hover { background: #ff66b3; transform: scale(1.05); }
        .sticker-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 800; }
        .sticker-item { position: absolute; cursor: move; pointer-events: all; transform-origin: center center; transition: all 0.1s ease; border-radius: 8px; overflow: hidden; /* ÁßªÈô§Ë¥¥Á∫∏ËæπÊ°ÜÂíåÈò¥ÂΩ± */ box-shadow: none; border: none; }
        .sticker-handle { position: absolute; bottom: 5px; right: 5px; width: 20px; height: 20px; background: #ff66b3; border-radius: 50%; cursor: nwse-resize; display: none; }
        /* ‰øÆÊîπÔºöÈöêËóèÂéüÊù•ÁöÑÊóãËΩ¨ÊâãÊüÑ */
        .sticker-rotate-handle { display: none; }
        /* Êñ∞Â¢ûÔºöÂ∑¶‰∏äËßíÊóãËΩ¨ÊèêÁ§∫ */
        .sticker-rotate-tip { position: absolute; top: 5px; left: 5px; width: 20px; height: 20px; background: #ff99cc; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 10px; cursor: grab; display: none; }
        /* Êñ∞Â¢ûÔºöÁøªËΩ¨ÊéßÂà∂ÊåâÈíÆ */
        .sticker-flip-handle { position: absolute; top: 5px; right: 5px; width: 20px; height: 20px; background: #ffb3d9; border-radius: 50%; cursor: pointer; display: none; }
        .sticker-item.editable .sticker-handle, 
        .sticker-item.editable .sticker-rotate-tip,
        .sticker-item.editable .sticker-flip-handle { display: flex; }
        /* Êñ∞Â¢ûÔºöÁøªËΩ¨ËèúÂçï */
        .sticker-flip-menu { position: absolute; top: 30px; left: 5px; background: white; border-radius: 8px; padding: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 10; display: none; }
        .flip-option { padding: 3px 8px; font-size: 12px; cursor: pointer; border-radius: 4px; }
        .flip-option:hover { background: #ffe6f2; }
        /* ÁßªÈô§Ë¥¥Á∫∏ÂÜÖÂõæÁâá/ËßÜÈ¢ëÁöÑËæπÊ°ÜÂíåÂúÜËßí */
        .sticker-item img, .sticker-item video { border: none !important; border-radius: 0 !important; outline: none !important; }

        /* ÁßªÂä®Á´Ø‰ºòÂåñ */
        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
                padding: 15px;
            }
            .sidebar h2 {
                margin-bottom: 15px;
            }
            .main-content {
                margin-left: 0;
                padding: 20px 15px;
            }
            .media-section {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
                gap: 10px;
            }
            .folder-item, .file-item {
                height: 140px;
                padding: 10px;
            }
            .home-page {
                flex-direction: column;
                gap: 30px;
            }
            .cartoon-img {
                width: 220px;
                height: 220px;
            }
            .profile-card {
                padding: 20px;
            }
            .sticker-button {
                width: 50px;
                height: 50px;
                font-size: 20px;
                bottom: 20px;
                right: 20px;
            }
            .sticker-toolbar {
                bottom: 80px;
                right: 20px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- ‰æßËæπÊ†è -->
    <div class="sidebar">
        <h2>Yomi's World</h2>
        <div class="login-section">
            <button class="login-btn" id="loginBtn">Management Login</button>
        </div>
        <button class="sidebar-btn" onclick="navigateTo('home')">üè† Home</button>
        <button class="sidebar-btn" onclick="navigateTo('study')">üìö Study Diary</button>
        <button class="sidebar-btn" onclick="navigateTo('vlog')">üé• Daily Vlog</button>
        <button class="sidebar-btn" onclick="navigateTo('week')">üìñ Week Diary</button>
        <button class="sidebar-btn" onclick="navigateTo('achieve')">üèÜ Achievements</button>
        <button class="sidebar-btn" onclick="navigateTo('target')">üéØ Personal Target</button>
    </div>

    <!-- ÂºπÁ™óÂå∫Âüü -->
    <div class="overlay" id="loginOverlay"></div>
    <div class="login-modal" id="loginModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">Management Login</h3>
        <input type="password" id="passwordInput" placeholder="Enter password">
        <button id="submitLogin" style="width: 100%; background: #ff66b3; color: white; border: none; border-radius: 15px; padding: 10px; cursor: pointer; margin-top: 1rem;">Login</button>
        <p id="loginError" style="color: #ff6666; margin-top: 0.5rem; display: none; text-align: center;">Wrong password!</p>
    </div>

    <div class="overlay" id="exitEditOverlay"></div>
    <div class="exit-edit-modal" id="exitEditModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">Exit Edit Mode?</h3>
        <p style="text-align: center; margin-bottom: 1rem; color: #5a2e48;">Are you sure you want to end edit mode?</p>
        <div style="display: flex; justify-content: center; gap: 10px;">
            <button id="confirmExitEdit" class="confirmBtn">Yes</button>
            <button id="cancelExitEdit" class="cancelBtn">No</button>
        </div>
    </div>

    <div class="overlay" id="stickerConfirmOverlay"></div>
    <div class="sticker-confirm-modal" id="stickerConfirmModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">Finish Sticker Editing?</h3>
        <p style="text-align: center; margin-bottom: 1rem; color: #5a2e48;">Are you sure you want to save the sticker changes?</p>
        <div style="display: flex; justify-content: center; gap: 10px;">
            <button id="confirmStickerBtn" class="confirmStickerBtn">Yes</button>
            <button id="cancelStickerBtn" class="cancelStickerBtn">No</button>
        </div>
    </div>

    <!-- Êñ∞Â¢ûÔºöÂà†Èô§Ë¥¥Á∫∏Á°ÆËÆ§ÂºπÁ™ó -->
    <div class="overlay" id="deleteStickerOverlay"></div>
    <div class="delete-sticker-modal" id="deleteStickerModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">Delete Sticker?</h3>
        <p style="text-align: center; margin-bottom: 1rem; color: #5a2e48;">Are you sure you want to delete this sticker?</p>
        <div style="display: flex; justify-content: center; gap: 10px;">
            <button id="confirmDeleteStickerBtn" class="confirmDeleteStickerBtn">Yes</button>
            <button id="cancelDeleteStickerBtn" class="cancelDeleteStickerBtn">No</button>
        </div>
    </div>

    <div class="overlay" id="achievementImageOverlay"></div>
    <div class="achievement-image-modal" id="achievementImageModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">üéâ Congratulations! üéâ</h3>
        <p style="text-align: center; margin-bottom: 1rem; color: #5a2e48;">You've completed all your goals for this year!</p>
        <img id="achievementImage" class="achievement-image" src="" alt="Achievement">
        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 1rem;">
            <button id="confirmAchievementBtn" class="confirmAchievementBtn">OK</button>
        </div>
    </div>

    <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
    <div class="main-content" id="main-content">
        <!-- ÊØè‰∏™È°µÈù¢Áã¨Á´ãÁöÑË¥¥Á∫∏ÂÆπÂô® -->
        <div id="home" class="page-content">
            <div class="sticker-container" id="stickerContainer_home"></div>
            <div class="home-page">
                <img src="https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/eff44eee1e6e4f2792c1775615dc2c74.JPG~tplv-a9rns2rl98-24:720:720.image?lk3s=8e244e95&rcl=202602080916150F3B363E9BA71B184F7A&rrcfp=8a172a1a&x-expires=1771118176&x-signature=rbjW80X3iJyV3cv9f5kR3omsSlc%3D" alt="Yomi's Profile" class="cartoon-img" id="profileImage">
                <div class="profile-card">
                    <h1>About Me üíñ</h1>
                    <div class="profile-edit-tools" id="profileEditTools">
                        <div class="edit-tool-group">
                            <span class="edit-tool-label">Text Color:</span>
                            <input type="color" class="color-picker" id="profileTextColor" value="#5a2e48">
                        </div>
                        <div class="edit-tool-group">
                            <span class="edit-tool-label">Font:</span>
                            <select class="font-select" id="profileFont">
                                <option value="Comic Sans MS, Arial Rounded MT Bold, sans-serif">Cute Font</option>
                                <option value="Arial, sans-serif">Arial</option>
                                <option value="Georgia, serif">Georgia</option>
                                <option value="Times New Roman, serif">Times New Roman</option>
                                <option value="Courier New, monospace">Courier</option>
                            </select>
                        </div>
                    </div>
                    <div class="profile-info" id="profileInfo" contenteditable="false" style="cursor: default;">
                        <p><span>Name:</span> Yomi Qiu</p>
                        <p><span>Birthday:</span> 2010.03.25</p>
                        <p><span>MBTI:</span> INTJ</p>
                        <p><span>Hobbies:</span> Playing Tennis, Finding Dilicious Food, Mediating</p>
                        <p><span>Self-introduction:</span> Hello! I'm Yomi, born on March 25, 2010. As an INTJ, I'm a thoughtful and independent person who loves to explore the world around me. I enjoy reading, creating art, and documenting my daily life through diaries and vlogs. This little corner of the internet is where I share my study journey, daily life, and personal goals. Welcome to my world!</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ÂêÑ‰∏™ÂäüËÉΩÈ°µÈù¢ -->
        <div id="study" class="page-content" style="display: none;">
            <div class="sticker-container" id="stickerContainer_study"></div>
            <h2 class="page-title">üìö Study Diary</h2>
            <section class="content-section">
                <h3 class="section-title">My Study Records</h3>
                <button class="add-folder-btn" id="studyAddFolderBtn" style="display: none;">+ Create New Folder</button>
                <div class="media-section" id="studyMedia"></div>
            </section>
        </div>

        <div id="vlog" class="page-content" style="display: none;">
            <div class="sticker-container" id="stickerContainer_vlog"></div>
            <h2 class="page-title">üé• Daily Vlog</h2>
            <section class="content-section">
                <h3 class="section-title">My Daily Life</h3>
                <button class="add-folder-btn" id="vlogAddFolderBtn" style="display: none;">+ Create New Folder</button>
                <div class="media-section" id="vlogMedia"></div>
            </section>
        </div>

        <div id="week" class="page-content" style="display: none;">
            <div class="sticker-container" id="stickerContainer_week"></div>
            <h2 class="page-title">üìñ Week Diary</h2>
            <section class="content-section">
                <h3 class="section-title">Weekly Reflections</h3>
                <button class="add-folder-btn" id="weekAddFolderBtn" style="display: none;">+ Create New Folder</button>
                <div class="media-section" id="weekMedia"></div>
            </section>
        </div>

        <div id="achieve" class="page-content" style="display: none;">
            <div class="sticker-container" id="stickerContainer_achieve"></div>
            <h2 class="page-title">üèÜ Achievements Showcase</h2>
            <section class="content-section">
                <h3 class="section-title">My Accomplishments</h3>
                <button class="add-folder-btn" id="achieveAddFolderBtn" style="display: none;">+ Create New Folder</button>
                <div class="media-section" id="achieveMedia"></div>
            </section>
        </div>

        <div id="target" class="page-content" style="display: none;">
            <div class="sticker-container" id="stickerContainer_target"></div>
            <h2 class="page-title">üéØ Personal Target</h2>
            <section class="content-section personal-target">
                <h3 class="section-title">My Goals & Dreams</h3>
                <button class="add-target-btn" id="addTargetBtn" style="display: none;">+ Add Target</button>
                <div class="target-list" id="targetList"></div>
            </section>
        </div>
    </div>

    <!-- ÂäüËÉΩÂºπÁ™ó -->
    <div class="overlay" id="createFolderOverlay"></div>
    <div class="create-folder-modal" id="createFolderModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">Create New Folder</h3>
        <input type="text" id="newFolderNameInput" placeholder="Enter folder name (e.g. Math Homework)">
        <div class="folder-icon-upload" id="folderIconUpload">
            <p style="color: #ff66b3;">üìÅ Click to upload folder icon</p>
            <div class="icon-preview" id="folderIconPreview">üìÅ</div>
            <input type="file" id="folderIconFileInput" accept="image/*" style="display: none;">
        </div>
        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 1rem;">
            <button id="confirmCreateFolderBtn" class="confirmCreateFolderBtn">Create</button>
            <button id="cancelCreateFolderBtn" class="cancelCreateFolderBtn">Cancel</button>
        </div>
    </div>

    <div class="overlay" id="folderPageOverlay"></div>
    <div class="folder-page-modal" id="folderPageModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;" id="folderPageTitle">Folder Content</h3>
        <button class="upload-media-btn" id="uploadMediaBtn">+ Upload Photo/Video</button>
        <div class="media-section" id="folderMediaContent"></div>
        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 1rem;">
            <button id="closeFolderPageBtn" class="close-folder-page">Close</button>
        </div>
    </div>

    <div class="overlay" id="targetOverlay"></div>
    <div class="target-modal" id="targetModal">
        <h3 style="color: #ff66b3; text-align: center; margin-bottom: 1rem;">Add/Edit Target</h3>
        <div class="target-form">
            <input type="text" id="targetYear" placeholder="Enter year (e.g. 2024)">
            <textarea id="targetContent" placeholder="Enter targets (one per line)&#10;e.g.&#10;Learn JavaScript&#10;Read 10 books&#10;Exercise 3 times a week"></textarea>
            <input type="hidden" id="targetId">
            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 1rem;">
                <button id="saveTargetBtn" class="saveTargetBtn">Save</button>
                <button id="cancelTargetBtn" class="cancelTargetBtn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Ë¥¥Á∫∏ÊåâÈíÆÂíåÊñ∞Â¢ûÁöÑÂ∑•ÂÖ∑Ê†è -->
    <div class="sticker-button" id="stickerButton">üç™</div>
    <div class="sticker-toolbar" id="stickerToolbar">
        <button class="sticker-tool-btn" id="addNewStickerBtn">‚ûï Add Sticker</button>
        <button class="sticker-tool-btn" id="flipHorizontalBtn">‚ÜîÔ∏è Horizontal</button>
        <button class="sticker-tool-btn" id="flipVerticalBtn">‚ÜïÔ∏è Vertical</button>
    </div>

    <script>
        // Ê†∏ÂøÉÂèòÈáè
        const PWD = "Shining0325!";
        let isAdmin = false, currMedia = "", currFolder = "", editTargetId = null, stickerEdit = false;
        let folderIcons = {}, folderNames = {}, folderContents = {}, targets = [];
        let idCounter = 1;
        let currentDeleteSticker = null;
        let selectedSticker = null;
        let currentPageId = 'home';
        let pageStickers = {
            home: [], study: [], vlog: [], week: [], achieve: [], target: []
        };

        let isRotating = false;
        let rotateStartX, rotateStartY, rotateStartAngle = 0;
        let rotateSticker = null;

        const quotes = [
            "Believe in yourself, you did it! ‚ú®", "Hard work pays off, congratulations! üéâ",
            "You're amazing, keep going! üí™", "Dream big, achieve bigger! üåü",
            "Success is the sum of small efforts! üìö", "You've crushed your goals, proud of you! ü•≥",
            "Every small step leads to big achievements! üöÄ", "Consistency is key, and you nailed it! üóùÔ∏è"
        ];

        // ====================== Êú¨Âú∞Â≠òÂÇ®Ê†∏ÂøÉ ======================
        function saveAllData() {
            const data = {
                folderIcons, folderNames, folderContents, targets, pageStickers, idCounter,
                profile: {
                    src: el("profileImage").src,
                    html: el("profileInfo").innerHTML,
                    color: el("profileInfo").style.color,
                    font: el("profileInfo").style.fontFamily
                }
            };
            localStorage.setItem("YomiWorldData", JSON.stringify(data));
        }

        function loadAllData() {
            const saved = localStorage.getItem("YomiWorldData");
            if (!saved) return;
            const data = JSON.parse(saved);
            
            folderIcons = data.folderIcons || {};
            folderNames = data.folderNames || {};
            folderContents = data.folderContents || {};
            targets = data.targets || [];
            pageStickers = data.pageStickers || { home: [], study: [], vlog: [], week: [], achieve: [], target: [] };
            idCounter = data.idCounter || 1;

            if (data.profile) {
                if (data.profile.src) el("profileImage").src = data.profile.src;
                if (data.profile.html) el("profileInfo").innerHTML = data.profile.html;
                if (data.profile.color) el("profileInfo").style.color = data.profile.color;
                if (data.profile.font) el("profileInfo").style.fontFamily = data.profile.font;
            }
            renderAll();
        }

        function renderAll() {
            renderTargets();
            ["study", "vlog", "week", "achieve"].forEach(sec => renderSection(sec));
            loadPageStickers("home");
        }

        function renderSection(section) {
            const container = el(`${section}Media`);
            container.innerHTML = "";
            Object.keys(folderIcons).forEach(fid => {
                const folder = document.createElement("div");
                folder.className = "folder-item";
                folder.dataset.id = fid;
                folder.innerHTML = `
                    <button class="delete-folder" style="display: ${isAdmin ? 'flex' : 'none'}">√ó</button>
                    <img src="${folderIcons[fid]}" class="folder-icon" alt="${folderNames[fid]}">
                    <div class="folder-name" contenteditable="${isAdmin}">${folderNames[fid]}</div>
                `;
                container.appendChild(folder);
                bindFolderEvents(folder, fid);
            });
        }

        // ====================== È°µÈù¢ÂØºËà™ ======================
        function navigateTo(pageId) {
            if (stickerEdit) finishSticker(true);
            document.querySelectorAll('.page-content').forEach(p => p.style.display = 'none');
            document.getElementById(pageId).style.display = 'block';
            currentPageId = pageId;
            if (isAdmin) el('stickerButton').style.display = 'flex';
            loadPageStickers(pageId);
        }

        const el = (id) => document.getElementById(id);
        const els = (cls) => document.querySelectorAll(cls);

        // ====================== ÁôªÂΩï/ÈÄÄÂá∫ ======================
        el("loginBtn").addEventListener("click", () => {
            if (!isAdmin) {
                el("loginModal").style.display = "block";
                el("loginOverlay").style.display = "block";
                el("passwordInput").focus();
            } else {
                el("exitEditModal").style.display = "block";
                el("exitEditOverlay").style.display = "block";
            }
        });

        el("confirmExitEdit").addEventListener("click", () => {
            isAdmin = false;
            el("exitEditModal").style.display = el("exitEditOverlay").style.display = "none";
            els(".add-folder-btn, .add-target-btn, .sticker-button, .profile-edit-tools").forEach(e => e.style.display = "none");
            els(".delete-folder, .delete-file, .target-edit-btn, .target-delete-btn").forEach(e => e.style.display = "none");
            el("profileInfo").contentEditable = false;
            el("profileInfo").style.cursor = "default";
            els('.folder-name, .file-name').forEach(x => { x.contentEditable = false; x.style.cursor = "default"; });
            if (stickerEdit) finishSticker(true);
            saveAllData();
            alert("‚ú® Edit mode ended! All changes saved.");
        });

        el("cancelExitEdit").addEventListener("click", () => {
            el("exitEditModal").style.display = el("exitEditOverlay").style.display = "none";
        });

        el("submitLogin").addEventListener("click", () => {
            if (el("passwordInput").value === PWD) {
                isAdmin = true;
                el("loginModal").style.display = el("loginOverlay").style.display = "none";
                els(".add-folder-btn").forEach(e => e.style.display = "inline-block");
                el("addTargetBtn").style.display = "inline-block";
                el("stickerButton").style.display = "flex";
                el("profileEditTools").style.display = "block";
                el("profileInfo").contentEditable = true;
                el("profileInfo").style.cursor = "text";
                els(".delete-folder, .delete-file").forEach(e => e.style.display = "flex");
                els(".target-edit-btn, .target-delete-btn").forEach(e => e.style.display = "inline-block");
                els('.folder-name, .file-name').forEach(x => { x.contentEditable = true; x.style.cursor = "text"; });
                alert("‚ú® Edit mode begin!");
            } else {
                el("loginError").style.display = "block";
                el("passwordInput").value = "";
            }
        });

        function closeModal(modalId, overlayId) {
            el(modalId).style.display = el(overlayId).style.display = "none";
        }

        el("loginOverlay").addEventListener("click", () => closeModal("loginModal", "loginOverlay"));
        el("exitEditOverlay").addEventListener("click", () => closeModal("exitEditModal", "exitEditOverlay"));
        el("cancelCreateFolderBtn").addEventListener("click", () => closeModal("createFolderModal", "createFolderOverlay"));
        el("createFolderOverlay").addEventListener("click", () => closeModal("createFolderModal", "createFolderOverlay"));
        el("closeFolderPageBtn").addEventListener("click", () => { closeModal("folderPageModal", "folderPageOverlay"); currFolder = ""; });
        el("folderPageOverlay").addEventListener("click", () => { closeModal("folderPageModal", "folderPageOverlay"); currFolder = ""; });
        el("cancelTargetBtn").addEventListener("click", () => { closeModal("targetModal", "targetOverlay"); editTargetId = null; });
        el("targetOverlay").addEventListener("click", () => { closeModal("targetModal", "targetOverlay"); editTargetId = null; });

        el("deleteStickerOverlay").addEventListener("click", () => closeModal("deleteStickerModal", "deleteStickerOverlay"));
        el("cancelDeleteStickerBtn").addEventListener("click", () => {
            closeModal("deleteStickerModal", "deleteStickerOverlay");
            currentDeleteSticker = null;
        });
        el("confirmDeleteStickerBtn").addEventListener("click", () => {
            if (currentDeleteSticker) {
                const stickerId = currentDeleteSticker.dataset.stickerId;
                pageStickers[currentPageId] = pageStickers[currentPageId].filter(s => s.id !== stickerId);
                currentDeleteSticker.remove();
                currentDeleteSticker = null;
            }
            closeModal("deleteStickerModal", "deleteStickerOverlay");
        });

        // ====================== Êñá‰ª∂Â§π ======================
        function openCreateFolder(section) {
            if (!isAdmin) return;
            currMedia = section;
            el("createFolderModal").style.display = "block";
            el("createFolderOverlay").style.display = "block";
            el("newFolderNameInput").value = "";
            el("folderIconPreview").innerHTML = "üìÅ";
            el("folderIconFileInput").value = "";
            setTimeout(() => el("newFolderNameInput").focus(), 100);
        }

        el("folderIconUpload").addEventListener("click", () => el("folderIconFileInput").click());
        el("folderIconFileInput").addEventListener("change", (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (ev) => {
                    el("folderIconPreview").innerHTML = `<img src="${ev.target.result}" width="80" height="80" style="object-fit: contain; border-radius: 10px;">`;
                };
                reader.readAsDataURL(file);
            }
        });

        el("confirmCreateFolderBtn").addEventListener("click", () => {
            const name = el("newFolderNameInput").value.trim();
            if (!name) { alert("Please enter a folder name!"); el("newFolderNameInput").focus(); return; }
            const folderId = `folder_${Date.now()}`;
            folderNames[folderId] = name;
            const preview = el("folderIconPreview").innerHTML;
            folderIcons[folderId] = preview.includes('img src=') ? preview.match(/src="(.*?)"/)[1] : "https://via.placeholder.com/70/ff66b3/ffffff?text=üìÅ";
            folderContents[folderId] = [];

            const folder = document.createElement("div");
            folder.className = "folder-item";
            folder.dataset.id = folderId;
            folder.innerHTML = `
                <button class="delete-folder" style="display: ${isAdmin ? 'flex' : 'none'}">√ó</button>
                <img src="${folderIcons[folderId]}" class="folder-icon" alt="${name}">
                <div class="folder-name" contenteditable="${isAdmin}">${name}</div>
            `;
            el(`${currMedia}Media`).appendChild(folder);
            bindFolderEvents(folder, folderId);
            closeModal("createFolderModal", "createFolderOverlay");
        });

        function bindFolderEvents(folder, folderId) {
            const nameEl = folder.querySelector('.folder-name');
            nameEl.addEventListener("blur", () => {
                if (!isAdmin) return;
                const newName = nameEl.textContent.trim() || "New Folder";
                nameEl.textContent = newName;
                folderNames[folderId] = newName;
            });
            folder.querySelector(".delete-folder").addEventListener("click", (e) => {
                e.stopPropagation();
                if (!isAdmin) return;
                if (confirm("Delete this folder?")) {
                    folder.remove();
                    delete folderIcons[folderId];
                    delete folderNames[folderId];
                    delete folderContents[folderId];
                }
            });
            folder.addEventListener("click", (e) => {
                if (e.target.classList.contains('delete-folder') || e.target.classList.contains('folder-name')) return;
                openFolder(folderId);
            });
        }

        function openFolder(folderId) {
            currFolder = folderId;
            el("folderPageTitle").textContent = folderNames[folderId] || "Folder";
            el("folderPageModal").style.display = "block";
            el("folderPageOverlay").style.display = "block";
            renderFolderMedia(folderId);
        }

        function renderFolderMedia(folderId) {
            el("folderMediaContent").innerHTML = "";
            if (!folderContents[folderId]) return;
            folderContents[folderId].forEach((file, idx) => {
                const item = document.createElement("div");
                item.className = "file-item";
                item.dataset.index = idx;
                let prev = file.type.startsWith("image/") 
                    ? `<img src="${file.url}" class="file-icon">`
                    : file.type.startsWith("video/") 
                    ? `<video src="${file.url}" class="file-icon" controls muted playsinline></video>`
                    : `<div class="file-icon" style="background:#ffd6e8;font-size:24px;color:#ff66b3;">üìÑ</div>`;
                
                item.innerHTML = `
                    <button class="delete-file" style="display:${isAdmin?'flex':'none'}">√ó</button>
                    ${prev}
                    <div class="file-name" contenteditable="${isAdmin}">${file.name}</div>
                `;
                el("folderMediaContent").appendChild(item);

                item.querySelector(".delete-file").addEventListener("click", (e) => {
                    e.stopPropagation();
                    if (!isAdmin) return;
                    if (confirm("Delete?")) {
                        folderContents[folderId].splice(idx,1);
                        renderFolderMedia(folderId);
                    }
                });
                item.querySelector(".file-name").addEventListener("blur", () => {
                    if (!isAdmin) return;
                    folderContents[folderId][idx].name = item.querySelector(".file-name").textContent.trim();
                });
            });
        }

        el("uploadMediaBtn").addEventListener("click", () => {
            if (!isAdmin || !currFolder) return;
            const input = document.createElement("input");
            input.type = "file";
            input.accept = "image/*,video/*";
            input.multiple = true;
            input.click();
            input.addEventListener("change", (e) => {
                for (let f of e.target.files) {
                    const url = URL.createObjectURL(f);
                    folderContents[currFolder].push({
                        name: f.name, originalName:f.name, type:f.type, url:url
                    });
                }
                renderFolderMedia(currFolder);
            });
        });

        el("studyAddFolderBtn").addEventListener("click", () => openCreateFolder("study"));
        el("vlogAddFolderBtn").addEventListener("click", () => openCreateFolder("vlog"));
        el("weekAddFolderBtn").addEventListener("click", () => openCreateFolder("week"));
                el("achieveAddFolderBtn").addEventListener("click", () => openCreateFolder("achieve"));

        // ====================== ÁõÆÊ†á Target ======================
        function renderTargets() {
            const container = el("targetList");
            container.innerHTML = "";
            const yearGroups = {};
            targets.forEach(t => {
                if (!yearGroups[t.year]) yearGroups[t.year] = [];
                yearGroups[t.year].push(t);
            });

            Object.keys(yearGroups).sort().forEach(year => {
                const yearDiv = document.createElement("div");
                yearDiv.className = "year-target-container";
                yearDiv.innerHTML = `
                    <div class="year-header">
                        <input type="checkbox" class="year-checkbox" data-year="${year}" ${targets.every(t=>t.year!=year||t.done)?'checked':''}>
                        <span class="year-label">${year} Âπ¥ÁõÆÊ†á</span>
                    </div>
                    <div class="goals-list" id="goals_${year}"></div>
                    <div class="target-actions">
                        <button class="target-edit-btn" data-year="${year}">Edit</button>
                        <button class="target-delete-btn" data-year="${year}">Delete</button>
                    </div>
                `;
                container.appendChild(yearDiv);

                const goalsList = yearDiv.querySelector(".goals-list");
                yearGroups[year].forEach((t, i) => {
                    const goalItem = document.createElement("div");
                    goalItem.className = "goal-item";
                    goalItem.innerHTML = `
                        <input type="checkbox" class="goal-checkbox" data-id="${t.id}" ${t.done?'checked':''}>
                        <div class="goal-content" ${t.done?'style="text-decoration:line-through;color:#999"':''}>${t.text}</div>
                    `;
                    goalsList.appendChild(goalItem);
                });
            });

            // ÁõÆÊ†áÂãæÈÄâ
            els(".goal-checkbox").forEach(cb => {
                cb.addEventListener("change", () => {
                    const id = cb.dataset.id;
                    const tar = targets.find(t=>t.id==id);
                    if (tar) tar.done = cb.checked;
                    renderTargets();
                    checkYearComplete();
                });
            });

            // ÁºñËæë/Âà†Èô§
            els(".target-edit-btn").forEach(btn => {
                btn.addEventListener("click", () => {
                    const year = btn.dataset.year;
                    const ts = targets.filter(t=>t.year==year);
                    if (!ts.length) return;
                    editTargetId = ts[0].id;
                    el("targetYear").value = year;
                    el("targetContent").value = ts.map(t=>t.text).join("\n");
                    el("targetModal").style.display = "block";
                    el("targetOverlay").style.display = "block";
                });
            });

            els(".target-delete-btn").forEach(btn => {
                btn.addEventListener("click", () => {
                    const year = btn.dataset.year;
                    if (!confirm("Delete this year's targets?")) return;
                    targets = targets.filter(t=>t.year!=year);
                    renderTargets();
                });
            });
        }

        function checkYearComplete() {
            const allYears = new Set(targets.map(t=>t.year));
            let fullDone = true;
            for (let y of allYears) {
                const ts = targets.filter(t=>t.year==y);
                if (!ts.every(t=>t.done)) {
                    fullDone = false;
                    break;
                }
            }
            if (fullDone && targets.length > 0) {
                const randomQuote = quotes[Math.floor(Math.random()*quotes.length)];
                el("achievementImage").src = "https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/eff44eee1e6e4f2792c1775615dc2c74.JPG~tplv-a9rns2rl98-24:720:720.image?lk3s=8e244e95&rcl=202602080916150F3B363E9BA71B184F7A&rrcfp=8a172a1a&x-expires=1771118176&x-signature=rbjW80X3iJyV3cv9f5kR3omsSlc%3D";
                el("achievementImageModal").style.display = "block";
                el("achievementImageOverlay").style.display = "block";
            }
        }

        el("addTargetBtn").addEventListener("click", () => {
            editTargetId = null;
            el("targetYear").value = "";
            el("targetContent").value = "";
            el("targetModal").style.display = "block";
            el("targetOverlay").style.display = "block";
        });

        el("saveTargetBtn").addEventListener("click", () => {
            const year = el("targetYear").value.trim();
            const content = el("targetContent").value.trim();
            if (!year || !content) { alert("Year & targets cannot be empty!"); return; }

            const lines = content.split("\n").map(l=>l.trim()).filter(l=>l);
            if (editTargetId != null) {
                const oldYear = targets.find(t=>t.id==editTargetId)?.year;
                targets = targets.filter(t=>t.id!=editTargetId && t.year!=oldYear);
            }
            lines.forEach(line => {
                targets.push({
                    id: idCounter++,
                    year: year,
                    text: line,
                    done: false
                });
            });
            closeModal("targetModal", "targetOverlay");
            renderTargets();
        });

        el("confirmAchievementBtn").addEventListener("click", () => {
            closeModal("achievementImageModal", "achievementImageOverlay");
        });

        // ====================== Ë¥¥Á∫∏ Sticker ======================
        el("stickerButton").addEventListener("click", () => {
            if (!isAdmin) return;
            stickerEdit = !stickerEdit;
            if (stickerEdit) {
                el("stickerToolbar").style.display = "block";
                els(".sticker-item").forEach(s=>s.classList.add("editable"));
            } else {
                el("stickerConfirmModal").style.display = "block";
                el("stickerConfirmOverlay").style.display = "block";
            }
        });

        el("confirmStickerBtn").addEventListener("click", () => {
            finishSticker(true);
        });
        el("cancelStickerBtn").addEventListener("click", () => {
            finishSticker(false);
        });

        function finishSticker(save) {
            stickerEdit = false;
            el("stickerToolbar").style.display = "none";
            el("stickerConfirmModal").style.display = el("stickerConfirmOverlay").style.display = "none";
            els(".sticker-item.editable").forEach(s=>s.classList.remove("editable"));
            if (save) saveAllData();
        }

        el("addNewStickerBtn").addEventListener("click", () => {
            const input = document.createElement("input");
            input.type = "file";
            input.accept = "image/*,video/*";
            input.click();
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const url = URL.createObjectURL(file);
                const stickerId = "sticker_"+idCounter++;
                const sticker = document.createElement("div");
                sticker.className = "sticker-item editable";
                sticker.dataset.stickerId = stickerId;
                sticker.style.left = "100px";
                sticker.style.top = "100px";
                sticker.style.width = "150px";

                if (file.type.startsWith("video/")) {
                    sticker.innerHTML = `
                        <video src="${url}" style="width:100%;height:auto;display:block;"></video>
                        <div class="sticker-rotate-tip">R</div>
                        <div class="sticker-flip-handle">F</div>
                        <div class="sticker-handle"></div>
                    `;
                } else {
                    sticker.innerHTML = `
                        <img src="${url}" style="width:100%;height:auto;display:block;">
                        <div class="sticker-rotate-tip">R</div>
                        <div class="sticker-flip-handle">F</div>
                        <div class="sticker-handle"></div>
                    `;
                }
                getStickerContainer().appendChild(sticker);
                pageStickers[currentPageId].push({
                    id: stickerId,
                    type: file.type.startsWith("video/")?"video":"image",
                    url: url,
                    x:100, y:100, w:150, h:"auto",
                    rotate:0, scaleX:1, scaleY:1
                });
                bindSticker(sticker);
            };
        });

        function getStickerContainer() {
            return el("stickerContainer_"+currentPageId);
        }

        function loadPageStickers(pageId) {
            const container = getStickerContainer();
            container.innerHTML = "";
            if (!pageStickers[pageId]) pageStickers[pageId] = [];
            pageStickers[pageId].forEach(s => {
                const item = document.createElement("div");
                item.className = "sticker-item"+(stickerEdit?" editable":"");
                item.dataset.stickerId = s.id;
                item.style.left = s.x+"px";
                item.style.top = s.y+"px";
                item.style.width = s.w+"px";
                item.style.transform = `rotate(${s.rotate}deg) scaleX(${s.scaleX}) scaleY(${s.scaleY})`;

                if (s.type === "video") {
                    item.innerHTML = `
                        <video src="${s.url}" style="width:100%;height:auto;display:block;"></video>
                        <div class="sticker-rotate-tip">R</div>
                        <div class="sticker-flip-handle">F</div>
                        <div class="sticker-handle"></div>
                    `;
                } else {
                    item.innerHTML = `
                        <img src="${s.url}" style="width:100%;height:auto;display:block;">
                        <div class="sticker-rotate-tip">R</div>
                        <div class="sticker-flip-handle">F</div>
                        <div class="sticker-handle"></div>
                    `;
                }
                container.appendChild(item);
                bindSticker(item);
            });
        }

        function bindSticker(sticker) {
            let startX, startY, origX, origY, origW, origH;
            let isResize = false;

            // ÊãñÂä®
            sticker.addEventListener("mousedown", (e) => {
                if (e.target.classList.contains("sticker-handle") 
                    || e.target.classList.contains("sticker-rotate-tip")
                    || e.target.classList.contains("sticker-flip-handle")) return;
                if (e.button !== 0) return;
                e.preventDefault();
                selectedSticker = sticker;
                startX = e.clientX;
                startY = e.clientY;
                origX = parseInt(sticker.style.left) || 0;
                origY = parseInt(sticker.style.top) || 0;

                function move(ev) {
                    const dx = ev.clientX - startX;
                    const dy = ev.clientY - startY;
                    sticker.style.left = origX + dx + "px";
                    sticker.style.top = origY + dy + "px";
                }
                function up() {
                    document.removeEventListener("mousemove", move);
                    document.removeEventListener("mouseup", up);
                    const sid = sticker.dataset.stickerId;
                    const s = pageStickers[currentPageId].find(x=>x.id===sid);
                    if (s) {
                        s.x = parseInt(sticker.style.left)||0;
                        s.y = parseInt(sticker.style.top)||0;
                    }
                }
                document.addEventListener("mousemove", move);
                document.addEventListener("mouseup", up);
            });

            // Áº©Êîæ
            const handle = sticker.querySelector(".sticker-handle");
            handle.addEventListener("mousedown", (e) => {
                e.preventDefault();
                isResize = true;
                startX = e.clientX;
                startY = e.clientY;
                origW = parseInt(sticker.style.width)||150;
                function move(ev) {
                    if (!isResize) return;
                    const dx = ev.clientX - startX;
                    const w = Math.max(50, origW + dx);
                    sticker.style.width = w + "px";
                }
                function up() {
                    isResize = false;
                    document.removeEventListener("mousemove", move);
                    document.removeEventListener("mouseup", up);
                    const sid = sticker.dataset.stickerId;
                    const s = pageStickers[currentPageId].find(x=>x.id===sid);
                    if (s) s.w = parseInt(sticker.style.width)||150;
                }
                document.addEventListener("mousemove", move);
                document.addEventListener("mouseup", up);
            });

            // ÊóãËΩ¨
            const rotateTip = sticker.querySelector(".sticker-rotate-tip");
            rotateTip.addEventListener("mousedown", (e) => {
                e.preventDefault();
                isRotating = true;
                rotateSticker = sticker;
                const rect = sticker.getBoundingClientRect();
                const cx = rect.left + rect.width/2;
                const cy = rect.top + rect.height/2;
                rotateStartAngle = Math.atan2(e.clientY - cy, e.clientX - cx) * 180 / Math.PI;

                function move(ev) {
                    if (!isRotating) return;
                    const ang = Math.atan2(ev.clientY - cy, ev.clientX - cx) * 180 / Math.PI;
                    const diff = ang - rotateStartAngle;
                    const sid = sticker.dataset.stickerId;
                    const s = pageStickers[currentPageId].find(x=>x.id===sid);
                    if (s) {
                        s.rotate = (s.rotate||0) + diff;
                        sticker.style.transform = `rotate(${s.rotate}deg) scaleX(${s.scaleX||1}) scaleY(${s.scaleY||1})`;
                    }
                    rotateStartAngle = ang;
                }
                function up() {
                    isRotating = false;
                    document.removeEventListener("mousemove", move);
                    document.removeEventListener("mouseup", up);
                }
                document.addEventListener("mousemove", move);
                document.addEventListener("mouseup", up);
            });

            // ÁøªËΩ¨
            const flipHandle = sticker.querySelector(".sticker-flip-handle");
            flipHandle.addEventListener("click", (e) => {
                e.stopPropagation();
                const sid = sticker.dataset.stickerId;
                const s = pageStickers[currentPageId].find(x=>x.id===sid);
                if (!s) return;
                if (e.ctrlKey || e.metaKey) {
                    s.scaleY = s.scaleY * -1;
                } else {
                    s.scaleX = s.scaleX * -1;
                }
                sticker.style.transform = `rotate(${s.rotate||0}deg) scaleX(${s.scaleX}) scaleY(${s.scaleY})`;
            });

            // Âà†Èô§
            sticker.addEventListener("dblclick", () => {
                if (!stickerEdit) return;
                currentDeleteSticker = sticker;
                el("deleteStickerModal").style.display = "block";
                el("deleteStickerOverlay").style.display = "block";
            });
        }

        // ====================== È¶ñÈ°µÂ§¥ÂÉè & Ê†∑ÂºèÁºñËæë ======================
        el("profileImage").addEventListener("click", () => {
            if (!isAdmin) return;
            const input = document.createElement("input");
            input.type = "file";
            input.accept = "image/*";
            input.click();
            input.onchange = (e) => {
                const f = e.target.files[0];
                if (!f) return;
                el("profileImage").src = URL.createObjectURL(f);
            };
        });

        el("profileTextColor").addEventListener("input", () => {
            el("profileInfo").style.color = el("profileTextColor").value;
        });
        el("profileFont").addEventListener("change", () => {
            el("profileInfo").style.fontFamily = el("profileFont").value;
        });

        // ====================== ÂàùÂßãÂåñ ======================
        window.addEventListener("DOMContentLoaded", () => {
            loadAllData();
            navigateTo("home");
        });

        window.addEventListener("beforeunload", (e) => {
            if (isAdmin) saveAllData();
        });
    </script>
</body>
</html>
